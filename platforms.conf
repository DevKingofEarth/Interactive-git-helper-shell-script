# ~/.config/repo-crafterFiles/platforms.conf
# Platform-specific logic is DEFINED HERE, not in code.

[github]
enabled = true
api_base = https://api.github.com
ssh_host = github.com
repo_domain = github.com
token_var = GITHUB_API_TOKEN
auth_header = Bearer {token}  # GitHub uses "token" prefix
accept_header = application/vnd.github+json  # GitHub API requires this
#auth_header_overrides = {"gists":"Bearer {token}"}  # Some endpoints need Bearer
# --- API Endpoint Patterns ---
repo_check_endpoint = /repos/{owner}/{repo}
repo_check_method = GET
# How to interpret the API response
repo_check_success_key = id
repo_create_endpoint = /user/repos
repo_create_method = POST
repo_list_endpoint = /user/repos?per_page=100&sort=updated
repo_list_success_key = .[0].id  # First repo has id field
repo_delete_endpoint = /repos/{owner}/{repo}
repo_delete_method = DELETE
#extras
work_dir = github.com
display_format = {name} ({visibility}) - git@{ssh_host}:{path}.git
payload_template = {"name":"{repo}","private":{private}}
ssh_url_template = git@{ssh_host}:{owner}/{repo}.git
# USER DETECTION - fully declarative
authenticated_user_endpoint = /user
authenticated_user_key = .login  # jq path to extract username

# ORG SUPPORT
organization_endpoint = /orgs/{owner}/repos
organization_auth_same = true  # Use same auth as user

owner_not_found_patterns = not found,does not exist,organization
ssh_url_fields = ssh_url,clone_url
visibility_map = {"private":"private","public":"public"}

[gitlab]
enabled = true
api_base = https://gitlab.com/api/v4
ssh_host = gitlab.com
repo_domain = gitlab.com
token_var = GITLAB_API_TOKEN
auth_header = Bearer {token}
accept_header = application/json  # GitHub uses "token" prefix
# --- API Endpoint Patterns ---
repo_check_endpoint = /projects/{owner}%2F{repo}
repo_check_method = GET
repo_check_success_key = id
repo_create_endpoint = /projects
repo_create_method = POST
repo_list_endpoint = /projects?membership=true&per_page=100&order_by=updated_at
repo_list_success_key = .[0].id
repo_delete_endpoint = /projects/{owner}%2F{repo}
repo_delete_method = DELETE
#extras
work_dir = gitlab.com
display_format = {name} ({visibility}) - git@{ssh_host}:{path}.git
payload_template = {"name":"{repo}","private":{private}}
ssh_url_template = git@{ssh_host}:{owner}/{repo}.git
# USER DETECTION - fully declarative
authenticated_user_endpoint = /user
authenticated_user_key = .username  # jq path to extract username

# ORG SUPPORT
organization_endpoint = /groups/{owner}/projects
organization_auth_same = true  # Use same auth as user

owner_not_found_patterns = not found,does not exist
ssh_url_fields = ssh_url_to_repo,http_url_to_repo
visibility_map = {"private":"private","public":"public"}

[multi]
work_dir = Multi-server